!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([/*!********************!*\
  !*** multi spring ***!
  \********************/
function(t,n,e){t.exports=e(/*! ./browser.js */3)},/*!********************!*\
  !*** ./request.js ***!
  \********************/
function(t,n){"use strict";function e(t){function e(e){var r=e;return/^https?:\/\/.+$/g.test(e)||(r=n.requestConfig.baseURL+"/"+e),r=r.replace(/\/{2,}/g,"/").replace(/:\//g,"://"),new o({url:r,method:t})}return e}function r(t){var n=t._links.self.href,e=new o({url:n,method:"GET"});return e.responseData=t,e.hasSend=!0,e}var o=function(){function t(t){this.options={headers:{}},this.hasSend=!1,this.response=null,this.error=null,Object.assign(this.options,n.requestConfig.globalFetchOptions,t)}return t.prototype.queryParam=function(t){if(null!=t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e+"="+t[e]);this.options.url=this.options.url.split("?")[0]+"?"+n.join("&")}return this},t.prototype.jsonBody=function(t){return this.options.body=JSON.stringify(t),this.options.headers["Content-Type"]="application/json",this},t.prototype.formBody=function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&n.push(e+"="+t[e]);return this.options.body=n.join("&"),this.options.headers["Content-Type"]="application/x-www-form-urlencoded",this},t.prototype.send=function(){var t=this;return new Promise(function(e,r){if(t.hasSend)null==t.error?e(t.responseData):r(t.error);else{t.hasSend=!0;var o=n.requestConfig.fetchStartHook,i=n.requestConfig.fetchEndHook;o&&o(t),fetch(t.options.url,t.options).then(function(n){t.response=n;var e=n.headers.get("content-type");return null==e?Promise.resolve():/.*json.*/.test(e)?n.json():n.text()}).then(function(n){return t.responseData=n,t.response.ok?Promise.resolve(n):Promise.reject(n)}).then(function(n){i&&i(t),e(n)})["catch"](function(n){t.error=n,i&&i(t),r(t)})}})},t.prototype.follow=function(t){var e=this,r=this;return new Promise(function(o,i){function s(e){var a=t.shift();if(a){var u=e._links,c=u[a];null!=c?(c=c.href,n.get(c).send().then(function(t){s(t)})["catch"](function(t){i(t)})):(r.error="no key="+a+" in links "+JSON.stringify(u,null,4),i(this))}else o(e)}e.send().then(function(t){s(t)})["catch"](function(t){i(t)})})},t}();n.Request=o,n.requestConfig={globalFetchOptions:{},baseURL:"/",fetchStartHook:null,fetchEndHook:null},n.get=e("GET"),n.post=e("POST"),n.patch=e("PATCH"),n.put=e("PUT"),n.deleteMethod=e("DELETE"),n.mockRequest=r},/*!******************!*\
  !*** ./index.js ***!
  \******************/
function(t,n,e){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}r(e(/*! ./request */1)),r(e(/*! ./entity */4))},/*!********************!*\
  !*** ./browser.js ***!
  \********************/
function(t,n,e){"use strict";function r(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}var o=e(/*! ./index */2);window.spring=o,r(e(/*! ./index */2))},/*!*******************!*\
  !*** ./entity.js ***!
  \*******************/
function(t,n,e){"use strict";function r(t){if(t instanceof Object)for(var n=t.constructor.prototype.__proto__;n instanceof Object;){if(n.constructor===u)return!0;n=n.__proto__}return!1}function o(t,n){if(typeof t==typeof n){if(r(t)&&r(n))return t.id==n.id||o(t.data(),n.data());if(Array.isArray(t)&&Array.isArray(n)){if(t.length===n.length){var e=!0;return t.forEach(function(t,r){e=e&&o(t,n[r])}),e}}else{if(!(t instanceof Object&&n instanceof Object))return t==n;for(var i in t){var s=!0;if(!t.hasOwnProperty(i)||!n.hasOwnProperty(i))return!1;s=s&&o(t[i],n[i])}}}return!1}function i(t){var n=function(t){function n(){t.apply(this,arguments)}return s(n,t),n}(u);return n.entityName=t,n}var s=this&&this.__extends||function(t,n){function e(){this.constructor=t}for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r]);t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)},a=e(/*! ./request */1);n.entityConfig={restBaseURL:"/"},n.isEntity=r,n.equal=o;var u=function(){function t(t){this._data={},this.modifyFields=[],this.patchData(t)}return t.prototype.href=function(){var t=this._data._links;if(null!=t)return t.self.href;if(this.id)return this.constructor.entityBaseURL()+"/"+this.id;throw new Error("entity without id can't map to backend service:\n"+JSON.stringify(this))},t.prototype.get=function(t){return this._data[t]},t.prototype.set=function(t,n){var e=this.get(t);o(e,n)||this.modifyFields.push(t),this._data[t]=n},t.prototype.data=function(){return this._data},t.prototype.patchData=function(t){for(var n in t)t.hasOwnProperty(n)&&this.set(n,t[n]);try{var e=t._links.self.href.split(/\//);e=e[e.length-1],null!=e&&(this.id=e)}catch(r){}},t.prototype.create=function(){var t=this;return new Promise(function(n,e){t.constructor.translateRelationEntity(t.data(),[]).then(function(n){return a.post(t.constructor.entityBaseURL()).jsonBody(n).send()}).then(function(e){t.patchData(e),t.modifyFields=[],n(e)})["catch"](function(t){e(t)})})},t.prototype.update=function(){var t=this;return new Promise(function(n,e){var r={};return 0==t.modifyFields.length?void n():(t.modifyFields.forEach(function(n){r.hasOwnProperty(n)||"_"===n[0]||t._data.hasOwnProperty(n)&&(r[n]=t.get(n))}),void t.constructor.translateRelationEntity(r,[]).then(function(n){return a.patch(t.href()).jsonBody(n).send()}).then(function(e){t.patchData(e),t.modifyFields=[],n(e)})["catch"](function(t){e(t)}))})},t.prototype.save=function(){return null!=this.id?this.update():this.create()},t.prototype.remove=function(){return this.constructor.remove(this.id)},t.prototype.fetch=function(){var t=this;return new Promise(function(n,e){t.constructor.findOne(t.id).then(function(e){var r=e.data();t.patchData(r),t.modifyFields=[],n(r)})["catch"](function(t){e(t)})})},t.prototype.follow=function(t){var n=this;return new Promise(function(e,r){function o(n){a.mockRequest(n).follow(t).then(function(t){e(t)})["catch"](function(t){r(t)})}null!=n._data._links?o(n.data()):n.fetch().then(function(){o(n.data())})})},t.prototype.fetchProperty=function(t,n){var e=this;return new Promise(function(r,o){e.follow([t]).then(function(o){var i=n.jsonToEntity(o);e.data()[t]=i,r(i)})["catch"](function(t){o(t)})})},t.prototype.fetchArrayProperty=function(t,n){var e=this;return new Promise(function(r,o){e.follow([t]).then(function(o){var i=n.jsonToEntityList(o);e.data()[t]=i,r(i)})["catch"](function(t){o(t)})})},t.entityBaseURL=function(){return n.entityConfig.restBaseURL+"/"+this.entityName},t.jsonToEntityList=function(t){var n=this,e=[],r=t._embedded[this.entityName];return r.forEach(function(t){e.push(n.jsonToEntity(t))}),e.page=t.page,e},t.jsonToEntity=function(t){var n=new this(t);return n.modifyFields=[],n},t.translateRelationEntity=function(t,n){var e=this;return new Promise(function(o,i){if(r(t)){for(var s=0;s<n.length;s++){var a=n[s];if(t===a)return void o(t.href())}n.push(t),t.save().then(function(){o(t.href())})["catch"](function(t){i(t)})}else if(Array.isArray(t)){var u=[];t.forEach(function(t){return u.push(e.translateRelationEntity(t,n))}),Promise.all(u).then(function(t){o(t)})["catch"](function(t){i(t)})}else if(null!=t&&t.constructor===Object){var c=[],f={},h=0;for(var p in t)t.hasOwnProperty(p)&&(f[h++]=p,c.push(e.translateRelationEntity(t[p],n)));Promise.all(c).then(function(t){for(var n={},e=0;e<t.length;e++)n[f[e]]=t[e];o(n)})["catch"](function(t){i(t)})}else o(t)})},t.findOne=function(t,n){var e=this;if(null!=t)return new Promise(function(r,o){a.get(e.entityBaseURL()+"/"+t).queryParam(n).send().then(function(t){r(e.jsonToEntity(t))})["catch"](function(t){o(t)})});throw new Error("require id")},t.findAll=function(t){var n=this;return new Promise(function(e,r){a.get(n.entityBaseURL()).queryParam(t).send().then(function(t){var r=n.jsonToEntityList(t);e(r)})["catch"](function(t){r(t)})})},t.search=function(t,n){var e=this;return new Promise(function(r,o){a.get(e.entityBaseURL()+"/search/"+t).queryParam(n).send().then(function(t){try{r(e.jsonToEntityList(t))}catch(n){r(e.jsonToEntity(t))}})["catch"](function(t){o(t)})})},t.remove=function(t){return a.deleteMethod(this.entityBaseURL()+"/"+t).send()},t.exposeProperty=function(t){Object.defineProperty(this.prototype,t,{get:function(){return this.get(t)},set:function(n){this.set(t,n)},enumerable:!0})},t}();n.Entity=u,n.extend=i}]);
//# sourceMappingURL=spring.min.js.map